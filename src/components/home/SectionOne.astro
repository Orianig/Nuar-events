---
import type { SectionOneProps } from '../../types';

const { image1, image2, title, paragraph, bullets = [], backgroundColor } = Astro.props as SectionOneProps;
---

<section id="section-one" class={`py-10 md:py-20 ${backgroundColor ?? 'bg-stone'}`}>
  <div class="container mx-auto px-6 max-w-7xl">
    <div class="md:hidden flex flex-col gap-6">
      <div class="section-one-m-title overflow-hidden">
        <h2 class="font-title text-3xl font-semibold text-bark leading-tight text-center pb-4">
          {title}
        </h2>
      </div>
      <div class="grid grid-cols-2 gap-3 pb-4 items-center">
        <div class="section-one-m-img1 relative overflow-hidden rounded-xl shadow-lg aspect-3/4 min-h-[200px]">
          <img src={image1} alt="" class="w-full h-full object-cover" />
        </div>
        <div class="section-one-m-para">
          <p class="font-body text-bark/90 text-sm leading-relaxed text-center">
            {paragraph}
          </p>
        </div>
      </div>
      <div class="grid grid-cols-2 gap-3 items-center">
        <ul class="section-one-m-bullets gap-2 list-none pl-0 flex flex-col items-start w-full">
          {bullets.map((bullet) => (
            <li class="flex items-start gap-2 font-body text-bark text-sm w-full">
              <span
                class="shrink-0 w-4 h-4 rounded-full border-2 border-bark/60 mt-0.5"
                aria-hidden="true"
              />
              <span>{bullet}</span>
            </li>
          ))}
        </ul>
        <div class="section-one-m-img2 relative overflow-hidden rounded-xl shadow-lg aspect-3/4 min-h-[200px]">
          <img src={image2} alt="" class="w-full h-full object-cover" />
        </div>
      </div>
    </div>

    <div class="hidden md:grid md:grid-cols-2 gap-8 items-stretch section-one-desktop">
      <div class="grid grid-cols-2 gap-7 h-full min-h-0 relative">
        <div class="section-one-img1 relative overflow-hidden rounded-2xl shadow-lg h-full min-h-0">
          <img src={image1} alt="" class="w-full h-full object-cover absolute inset-0" />
        </div>
        <div class="section-one-img2 relative overflow-hidden rounded-2xl shadow-lg h-full min-h-0">
          <img src={image2} alt="" class="w-full h-full object-cover absolute inset-0" />
        </div>
      </div>
      <div class="md:pl-8 md:border-l md:border-dashed md:border-bark/20 flex flex-col">
        <div class="section-one-title w-full text-center md:text-left mb-6 overflow-hidden">
          <h2 class="font-title text-4xl font-semibold text-bark leading-tight inline">
            {title}
          </h2>
        </div>
        <div class="section-one-text">
          <p class="font-body text-bark/90 text-base leading-relaxed mb-6">
            {paragraph}
          </p>
          <ul class="gap-4 list-none pl-0 flex flex-col">
            {bullets.map((bullet) => (
              <li class="flex items-start gap-3 font-body text-bark text-base">
                <span
                  class="shrink-0 w-5 h-5 rounded-full border-2 border-bark/60 mt-0.5"
                  aria-hidden="true"
                />
                <span>{bullet}</span>
              </li>
            ))}
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  @media (min-width: 768px) {
    #section-one .section-one-img1,
    #section-one .section-one-img2,
    #section-one .section-one-text {
      opacity: 0;
    }
    #section-one .section-one-img1 {
      transform-origin: top left;
      transform: scale(0);
    }
    #section-one .section-one-img2 {
      transform-origin: bottom right;
      transform: scale(0);
    }
    #section-one .section-one-title {
      overflow: hidden;
    }
    #section-one .section-one-title h2 {
      display: inline-block;
      opacity: 0;
      transform: translateX(-100%);
    }
    #section-one .section-one-text {
      transform-origin: top left;
      transform: scale(0.92);
    }

    #section-one.section-one-in-view .section-one-img1 {
      animation: section-one-scale-tl 0.85s ease-out forwards;
    }
    #section-one.section-one-in-view .section-one-img2 {
      animation: section-one-scale-br 0.85s ease-out 0.85s forwards;
    }
    #section-one.section-one-in-view .section-one-title h2 {
      animation: section-one-reveal-lr 0.75s ease-out 1.7s forwards;
    }
    #section-one.section-one-in-view .section-one-text {
      animation: section-one-text-in 0.75s ease-out 2.45s forwards;
    }
  }

  @keyframes section-one-text-in {
    from {
      opacity: 0;
      transform: scale(0.92);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  @keyframes section-one-scale-tl {
    from {
      opacity: 0;
      transform: scale(0);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  @keyframes section-one-scale-br {
    from {
      opacity: 0;
      transform: scale(0);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  @keyframes section-one-reveal-lr {
    from {
      opacity: 0;
      transform: translateX(-100%);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @media (max-width: 767px) {
    #section-one .section-one-m-title h2 {
      display: inline-block;
      opacity: 0;
      transform: translateX(-100%);
    }
    #section-one .section-one-m-img1 {
      transform-origin: top left;
      transform: scale(0);
      opacity: 0;
    }
    #section-one .section-one-m-para {
      transform-origin: top left;
      transform: scale(0);
      opacity: 0;
    }
    #section-one .section-one-m-bullets {
      opacity: 0;
    }
    #section-one .section-one-m-img2 {
      transform-origin: bottom right;
      transform: scale(0);
      opacity: 0;
    }

    #section-one.section-one-m-section-in-view .section-one-m-title h2 {
      animation: section-one-m-reveal-lr 0.8s ease-out 0s forwards;
    }
    #section-one.section-one-m-section-in-view .section-one-m-img1 {
      animation: section-one-m-scale-tl 0.8s ease-out 0.8s forwards;
    }
    #section-one.section-one-m-section-in-view .section-one-m-para {
      animation: section-one-m-scale-tl 0.8s ease-out 1.6s forwards;
    }
    #section-one.section-one-m-section-in-view .section-one-m-img2 {
      animation: section-one-m-scale-br 0.65s ease-out 2.4s forwards;
    }
    #section-one.section-one-m-section-in-view .section-one-m-bullets {
      animation: section-one-m-fade-in 0.55s ease-out 3.05s forwards;
    }
  }

  @keyframes section-one-m-reveal-lr {
    from {
      opacity: 0;
      transform: translateX(-100%);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }
  @keyframes section-one-m-scale-tl {
    from {
      opacity: 0;
      transform: scale(0);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  @keyframes section-one-m-scale-br {
    from {
      opacity: 0;
      transform: scale(0);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  @keyframes section-one-m-fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
</style>

<script>
  const section = document.getElementById('section-one');
  if (section) {
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add('section-one-in-view');
            entry.target.classList.add('section-one-m-section-in-view');
          }
        });
      },
      { rootMargin: '0px 0px -8% 0px', threshold: 0 }
    );
    observer.observe(section);
  }
</script>
